classDiagram
%% =====================
%% CORE DOMAIN ENTITIES
%% =====================

    class Account {
        +long userId
        +String username
        +String email
        +String password
        +AccountType role
        +boolean active
    }

    class ChargingLocation {
        +Long locationId
        +String name
        +String address
        +List~ChargingStation~ stations
    }

    class ChargingStation {
        +Long stationId
        +Long locationId
        +String stationName
        +StationType type
        +int capacityKW
        +StationStatus status
        +Double pricing
    }

    class ChargingProcess {
        +Long sessionId
        +Long customerId
        +Long stationId
        +String stationName
        +ChargingMode mode
        +int batteryPercentage
        +int targetBatteryPercentage
        +int powerKW
        +int timeToFullMinutes
        +int expectedRangeKm
        +int drivenDistanceKm
        +SessionStatus status

        +updateBatteryPercentage(int)
        +complete()
        +isDrivenDistanceWithinTolerance(int) boolean
    }

    class PricingRules {
        +int pricingId
        +int locationId
        +int validFrom
        +int validTo
        +boolean active
        +List~PriceComponent~ priceComponents
    }

    class Invoice {
        +String invoiceId
        +Date startTime
        +Date endTime
        +double kWh
        +int durationMinutes
        +String mode
        +String stationName
        +double pricePerKWh
        +double totalAmount
        +InvoiceStatus status
        +String pricingRuleId
    }

%% =====================
%% MANAGER / SERVICES
%% =====================

    class AccountManager {
        -List~Account~ accounts
        +getInstance() AccountManager
        +addAccount(Account)
        +readAccount(long) Account
        +updateAccount(boolean,long)
        +updateAccount(String,long)
    }

    class ChargingLocationManager {
        -List~ChargingLocation~ locations
        -long idCounter
        +getInstance() ChargingLocationManager
        +createLocation(String,String) ChargingLocation
        +addLocation(ChargingLocation)
        +getAllLocations() List~ChargingLocation~
        +clear()
    }

    class StationManager {
        -Map~Long,ChargingLocation~ locations
        -Map~Long,ChargingStation~ stations
        -long stationIdCounter
        +getInstance() StationManager
        +addLocation(ChargingLocation)
        +createStation(Long,String,StationType,int,double) ChargingStation
        +getAllStationInformation() String
        +getStation(Long) ChargingStation
    }

    class ChargingProcessManager {
        -Map~Long,ChargingProcess~ processes
        -long sessionIdCounter
        +getInstance() ChargingProcessManager
        +startProcess(Long,Long,String,ChargingMode,int,int,int,int) ChargingProcess
        +getProcess(Long) ChargingProcess
        +updateBatteryPercentage(Long,int)
        +completeProcess(Long)
        +getAllProcesses() Map~Long,ChargingProcess~
        +clear()
    }

    class PricingManager {
        -List~PricingRules~ pricingRules
        +addPricingRule(PricingRules)
        +getActivePricingRules() List~PricingRules~
        +findPricingForLocation(int) PricingRules
    }

    class InvoiceManager {
        -List~Invoice~ invoices
        -double currentPrice
        +setCurrentPrice(double)
        +createInvoiceFromSession(double,int,String,String,Date,Date,String)
        +getInvoice(int) Invoice
        +viewDetails(Invoice) String
        +downloadPDF(Invoice) String
        +viewHistory() String
    }

%% ==========
%% ENUMS
%% ==========

    class AccountType {
        <<enum>>
        CUSTOMER
        OWNER
        ADMIN
    }

    class StationType {
        <<enum>>
        AC
        DC
        HPC
    }

    class StationStatus {
        <<enum>>
        AVAILABLE
        CHARGING
        MAINTENANCE
        OFFLINE
    }

    class ChargingMode {
        <<enum>>
        FAST
        STANDARD
        ECO
    }

    class SessionStatus {
        <<enum>>
        ACTIVE
        COMPLETED
        CANCELLED
        INTERRUPTED
    }

    class PriceComponent {
        <<enum>>
        KWH_AC
        KWH_DC
        MINUTE_FEE
        SESSION_FEE
    }

    class InvoiceStatus {
        <<enum>>
        OPEN
        PAID
        CANCELLED
    }

%% =====================
%% RELATIONSHIPS
%% =====================

%% Accounts & Processes / Invoices
    Account "1" --> "*" ChargingProcess : "customerId"
    Account "1" --> "*" Invoice : "billed to"

%% Locations & Stations
    ChargingLocation "1" --> "*" ChargingStation : "stations"

%% Stations & Processes
    ChargingStation "1" --> "*" ChargingProcess : "used in"

%% Locations & Pricing
    ChargingLocation "1" --> "0..*" PricingRules : "pricing rules for location"
    PricingRules "1" --> "*" PriceComponent : "uses"

%% Processes & Invoices
    ChargingProcess "1" --> "0..1" Invoice : "invoiced as"

%% Managers & Entities
    AccountManager ..> Account : "manages"
    ChargingLocationManager ..> ChargingLocation : "manages"
    StationManager ..> ChargingStation : "manages"
    StationManager ..> ChargingLocation : "knows"
    ChargingProcessManager ..> ChargingProcess : "manages"
    PricingManager ..> PricingRules : "manages"
    InvoiceManager ..> Invoice : "manages"

%% Enums usage
    Account --> AccountType
    ChargingStation --> StationType
    ChargingStation --> StationStatus
    ChargingProcess --> ChargingMode
    ChargingProcess --> SessionStatus
    Invoice --> InvoiceStatus
